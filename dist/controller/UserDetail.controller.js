sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter"],function(e,t,i){"use strict";return e.extend("auths.controller.UserDetail",{formatter:i,onInit:function(){var e=this.getOwnerComponent().getRouter();e.attachRouteMatched(this.onRouteMatched,this);this.getRouter().getRoute("UserDetail").attachPatternMatched(this._onObjectMatched,this);document.addEventListener("keydown",this.handleF8Pressed.bind(this))},handleF8Pressed:function(e){if(e.which===119){var t=this;t.onSaveChanges()}},onRouteMatched:function(){var e=new t({editable:false,createMethod:false});this.getView().setModel(e,"UserDetail")},onSaveChanges:function(){var e=this;var t=this.getModel();if(!this.getModel("UserDetail").getProperty("/createMethod")){var i=this.getModel("UserDetail").getProperty("/sPath");var s=t.getObject(i);delete s.__metadata;s.Partner=this.byId("inPartner").getSelectedKey();s.Name=this.byId("inName").getValue();s.Contact=this.byId("inContact").getValue();s.Nationality=this.byId("inNationality").getSelectedKey();s.BirthDate=this.byId("DP2").getDateValue();s.UsrEmail=this.byId("inEmail").getValue();s.UsrTypeId=this.byId("inUsrTypeId").getSelectedKey();s.Password=this.byId("inPassword").getValue();s.RoleId=this.byId("inRoleId").getSelectedKey();t.update(i,s,{success:function(t){e.getModel().refresh(true);sap.m.MessageBox.success("Utilizador Atualizado")},error:function(e){var t=JSON.parse(e.responseText).error.message.value;sap.m.MessageBox.alert(t,{icon:"ERROR",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}})}else{var a={};var r=true;a.Partner=this.byId("inPartner").getSelectedKey();a.Name=this.byId("inName").getValue();a.Contact=this.byId("inContact").getValue();a.Nationality=this.byId("inNationality").getSelectedKey();a.BirthDate=this.byId("DP2").getDateValue();a.UsrEmail=this.byId("inEmail").getValue();a.UsrTypeId=this.byId("inUsrTypeId").getSelectedKey();a.Password=this.byId("inPassword").getValue();a.RoleId=this.byId("inRoleId").getSelectedKey();t.create("/xTQAxUSR01_DD",a,{success:function(t){sap.m.MessageBox.success("Utilizador criado com sucesso");e.getRouter().navTo("RouteMain");e.getModel().refresh(true)},error:function(e){var t=JSON.parse(e.responseText).error.message.value;sap.m.MessageBox.alert(t,{icon:"ERROR",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}})}},onPermToChange:function(e){var t=this.getModel("UserDetail").getProperty("/editable");if(t){this.getModel("UserDetail").setProperty("/editable",false);e.oSource.setProperty("icon","sap-icon://edit")}else{this.getModel("UserDetail").setProperty("/editable",true);e.oSource.setProperty("icon","sap-icon://not-editable")}},onNavBack:function(){this.getRouter().navTo("RouteMain")},_onObjectMatched:function(e){var t="/xTQAxUSR01_DD"+e.getParameter("arguments").objectId;this._bindView(t)},_bindView:function(e){this.getModel("UserDetail").setProperty("/sPath",e);this.getModel("UserDetail").setProperty("/editable",false);this.getModel("UserDetail").setProperty("/createMethod",false);var t=this.getModel("UserDetail");if(e!="/xTQAxUSR01_DD('000')"){this.byId("SimpleFormDisplayColumn_threeGroups234").setTitle("Detalhes Utilizador");this.getView().bindElement({path:e,events:{dataRequested:function(){t.setProperty("/busy",true)},dataReceived:function(e){t.setProperty("/busy",false)}}})}else{this.onCreateMethod()}},onCreateMethod:function(){this.byId("SimpleFormDisplayColumn_threeGroups234").setTitle("Criar Utilizador");this.byId("inPartner").setValue("");this.byId("inEmail").setValue("");this.byId("inName").setValue("");this.byId("inContact").setValue("");this.byId("inNationality").setValue("");this.byId("DP2").setValue("");this.getModel("UserDetail").setProperty("/editable",true);this.byId("MainPage").setTitle("");this.getModel("UserDetail").setProperty("/createMethod",true)}})});
//# sourceMappingURL=UserDetail.controller.js.map