sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel"],function(e,t){"use strict";return e.extend("auths.controller.Detail",{onInit:function(){sessionStorage.setItem("goToLaunchpad","");var e=new t;this.getView().setModel(e,"Detail");this.getRouter().getRoute("Detail").attachPatternMatched(this._onObjectMatched,this)},onNavBack:function(){sessionStorage.setItem("goToLaunchpad","X");this.getRouter().navTo("RouteMain")},onAfterRendering:function(){var e=this;sessionStorage.setItem("goToLaunchpad","");window.addEventListener("message",function(t){var a=t.data;if(a.action=="goToMainPage"){e.onNavBack()}})},_onObjectMatched:function(e){var t="/AuthorizationsHeader"+e.getParameter("arguments").objectId;this._bindView(t)},_requestAllapps:function(e){var t=this,a=this.getModel();this.getModel("Detail").setProperty("/sPath",e);var n={$expand:"AuthorizationItems"};a.read(e,{urlParameters:n,success:function(e,a){t._loadAllapps(e.AuthorizationItems.results)},error:function(e){console.error("Erro na solicitação:",e)}})},getGroupHeader:function(e){return new GroupHeaderListItem({title:e.key,upperCase:false})},_loadAllapps:function(e){var t=this.byId("vbContent");t.destroyItems();var a=new sap.m.Table({id:"itContent",mode:sap.m.ListMode.Emphasized,headerToolbar:new sap.m.Toolbar({content:[new sap.m.Title({text:this.getView().getModel("i18n").getResourceBundle().getText("applicationconfiguration")})]})});a.addColumn(new sap.m.Column({mergeDuplicates:true,header:new sap.m.Label({text:this.getView().getModel("i18n").getResourceBundle().getText("GrpTitle")})}));a.addColumn(new sap.m.Column({header:new sap.m.Label({text:this.getView().getModel("i18n").getResourceBundle().getText("AppHeader")})}));a.addColumn(new sap.m.Column({header:new sap.m.Label({text:this.getView().getModel("i18n").getResourceBundle().getText("AppSubheader")})}));a.addColumn(new sap.m.Column({header:new sap.m.Label({text:this.getView().getModel("i18n").getResourceBundle().getText("Creatable")}),hAlign:sap.ui.core.TextAlign.Center}));a.addColumn(new sap.m.Column({header:new sap.m.Label({text:this.getView().getModel("i18n").getResourceBundle().getText("Readable")}),hAlign:sap.ui.core.TextAlign.Center}));a.addColumn(new sap.m.Column({header:new sap.m.Label({text:this.getView().getModel("i18n").getResourceBundle().getText("Updatable")}),hAlign:sap.ui.core.TextAlign.Center}));a.addColumn(new sap.m.Column({header:new sap.m.Label({text:this.getView().getModel("i18n").getResourceBundle().getText("Deletable")}),hAlign:sap.ui.core.TextAlign.Center}));var n=new sap.ui.model.json.JSONModel;n.setData({apps:e});a.setModel(n);a.bindItems("/apps",new sap.m.ColumnListItem({cells:[new sap.m.Text({text:"{GrpTitle}"}),new sap.m.HBox({items:[new sap.ui.core.Icon({src:"{AppIcon}",size:"1rem"}),new sap.m.Text({text:"{AppHeader}",wrapping:false,layoutData:new sap.m.FlexItemData({growFactor:1})}).addStyleClass("sapUiTinyMarginBegin")]}),new sap.m.Text({text:"{AppSubheader}"}),new sap.m.CheckBox({selected:{path:"Creatable",formatter:function(e){if(e==="X"){return true}else{return false}}},select:function(e){var t=e.getParameter("selected");if(t)t="X";else t="";var a=e.getSource().getBindingContext();a.getModel().setProperty("Creatable",t,a);n.refresh()}}),new sap.m.CheckBox({selected:{path:"Readable",formatter:function(e){if(e==="X"){return true}else{return false}}},select:function(e){var t=e.getParameter("selected");if(t)t="X";else t="";var a=e.getSource().getBindingContext();a.getModel().setProperty("Readable",t,a);n.refresh()}}),new sap.m.CheckBox({selected:{path:"Updatable",formatter:function(e){if(e==="X"){return true}else{return false}}},select:function(e){var t=e.getParameter("selected");if(t)t="X";else t="";var a=e.getSource().getBindingContext();a.getModel().setProperty("Updatable",t,a);n.refresh()}}),new sap.m.CheckBox({selected:{path:"Deletable",formatter:function(e){if(e==="X"){return true}else{return false}}},select:function(e){var t=e.getParameter("selected");if(t)t="X";else t="";var a=e.getSource().getBindingContext();a.getModel().setProperty("Deletable",t,a);n.refresh()}})]}));t.addItem(a);a.getBinding("items").sort(new sap.ui.model.Sorter("GrpTitle",false,false))},addNewLine:function(){var e=sap.ui.getCore().byId("itContent"),t=e.getModel(),a=t.getData(),n={AppHeader:"Novo Cabeçalho",AppSubheader:"Novo Subcabeçalho",Creatable:false,Readable:true,Updatable:false,Deletable:true};a.apps.push(n);t.setData(a);t.refresh()},onSaveData:function(){var e=this,t=this.getModel(),a=sap.ui.getCore().byId("itContent"),n=a.getModel(),o=n.getData().apps,s=this.getModel("Detail").getProperty("/sPath"),r=this.getModel().getObject(s);delete r.__metadata;for(let e=0;e<o.length;e++){delete o[e].__metadata}if(this.getModel("global").getProperty("/newRole")!=null){r.RoleName=this.getModel("global").getProperty("/newRole")}r.AuthorizationItems=o;var i=e.getModel("global").getProperty("/create");t.create("/AuthorizationsHeader",r,{headers:{creatable:i},success:function(t){new sap.m.MessageBox.success(e.getResourceBundle().getText("roleSuccessText"),{title:e.getResourceBundle().getText("roleSuccessTitle"),actions:[sap.m.MessageBox.Action.OK],emphasizedAction:sap.m.MessageBox.Action.OK,onClose:function(t){if(t===sap.m.MessageBox.Action.OK){e.getRouter().navTo("RouteMain");e.getModel("global").setProperty("/create","false")}}})},error:function(e){check=false}})},onNavBack:function(){sessionStorage.setItem("goToLaunchpad","X");this.getRouter().navTo("RouteMain")},_bindView:function(e){var t=this,a=e,n=this.getModel("Detail");this.getView().bindElement({path:e,events:{dataRequested:function(){n.setProperty("/busy",true)},dataReceived:function(e){n.setProperty("/busy",false)}}});t._requestAllapps(a)}})});
//# sourceMappingURL=Detail.controller.js.map