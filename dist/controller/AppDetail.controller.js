sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/ui/layout/form/SimpleForm"],function(e,t,a){"use strict";return e.extend("auths.controller.AppDetail",{onInit:function(){var e=this.getOwnerComponent().getRouter();e.attachRouteMatched(this.onRouteMatched,this);this.getRouter().getRoute("AppDetail").attachPatternMatched(this._onObjectMatched,this);document.addEventListener("keydown",this.handleF8Pressed.bind(this))},handleF8Pressed:function(e){if(e.which===119){var t=this;t.onSaveChanges()}},onRouteMatched:function(){var e=new t({editable:false,createMethod:false});this.getView().setModel(e,"AppDetail");this.byId("inAppHeader").setValue("");this.byId("inAppSubHeader").setValue("");this.byId("inAppIcon").setValue("");this.byId("inAppFooter").setValue("");this.byId("inAppLink").setValue("");this.byId("inAppLangu").setValue("EN");this.byId("btCreateUpdate").setText("Save");this.byId("btChange").setProperty("visible",true)},onIconSearchPressed:function(){window.open("https://sapui5.hana.ondemand.com/sdk/test-resources/sap/m/demokit/iconExplorer/webapp/index.html#/overview/SAP-icons")},onSaveChanges:function(){var e=this;var t=this.getModel();var a=true;var i=this.byId("btChange");if(!this.getModel("AppDetail").getProperty("/createMethod")){var s=this.getModel("AppDetail").getProperty("/sPath");var o=t.getObject(s);delete o.__metadata;var n={};n.app_header=this.byId("inAppHeader").getValue()!=o.app_header?this.byId("inAppHeader").getValue():o.app_header;n.app_subheader=this.byId("inAppSubHeader").getValue()!=o.app_subheader?this.byId("inAppSubHeader").getValue():o.app_subheader;n.app_icon=this.byId("inAppIcon").getValue()!=o.app_icon?this.byId("inAppIcon").getValue():o.app_icon;n.app_footer=this.byId("inAppFooter").getValue()!=o.app_footer?this.byId("inAppFooter").getValue():o.app_footer;n.app_link=this.byId("inAppLink").getValue()!=o.app_link?this.byId("inAppLink").getValue():o.app_link;n.grp_id=this.byId("inGrpTitle").getSelectedKey()!=o.grp_id?this.byId("inGrpTitle").getSelectedKey():o.grp_id;if(this.byId("inAppActived").getSelectedKey()=="true")n.app_actived=true;else n.app_actived=false;if(n.app_header){this.byId("inAppHeader").setValueState("None")}else{this.byId("inAppHeader").setValueState("Error");a=false}if(n.app_subheader){this.byId("inAppSubHeader").setValueState("None")}else{this.byId("inAppSubHeader").setValueState("Error");a=false}if(n.app_icon&&sap.ui.core.IconPool.isIconURI(n.app_icon)){this.byId("inAppIcon").setValueState("None")}else{this.byId("inAppIcon").setValueState("Error");a=false}if(n.app_footer){this.byId("inAppFooter").setValueState("None")}else{this.byId("inAppFooter").setValueState("Error");a=false}if(n.app_link){this.byId("inAppLink").setValueState("None")}else{this.byId("inAppLink").setValueState("Error");a=false}if(a){t.update(s,n,{success:function(t){sap.m.MessageBox.success("Aplicação Atualizada");e.onPermToChange(i);e.getModel().refresh(true)},error:function(e){var t=JSON.parse(e.responseText).error.message.value;sap.m.MessageBox.alert(t,{icon:"ERROR",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}})}}else{var n={};var p=true;n.app_header=this.byId("inAppHeader").getValue();n.app_subheader=this.byId("inAppSubHeader").getValue();n.app_icon=this.byId("inAppIcon").getValue();n.app_footer=this.byId("inAppFooter").getValue();n.app_link=this.byId("inAppLink").getValue();n.grp_id=this.byId("inGrpTitle").getSelectedKey();n.app_actived=this.byId("inAppActived").getSelectedKey()==="true";if(n.app_header){this.byId("inAppHeader").setValueState("None")}else{this.byId("inAppHeader").setValueState("Error");p=false}if(n.app_subheader){this.byId("inAppSubHeader").setValueState("None")}else{this.byId("inAppSubHeader").setValueState("Error");p=false}if(n.app_icon&&sap.ui.core.IconPool.isIconURI(n.app_icon)){this.byId("inAppIcon").setValueState("None")}else{this.byId("inAppIcon").setValueState("Error");p=false}if(n.app_footer){this.byId("inAppFooter").setValueState("None")}else{this.byId("inAppFooter").setValueState("Error");p=false}if(n.app_link){this.byId("inAppLink").setValueState("None")}else{this.byId("inAppLink").setValueState("Error");p=false}if(p){t.create("/xTQAxAPPLICATIONS_DD",n,{success:function(t){sap.m.MessageBox.success("Aplicação criada com sucesso");e.onPermToChange(i);e.getRouter().navTo("RouteMain");e.getModel().refresh(true)},error:function(e){var t=JSON.parse(e.responseText).error.message.value;sap.m.MessageBox.alert(t,{icon:"ERROR",onClose:null,styleClass:"",initialFocus:null,textDirection:sap.ui.core.TextDirection.Inherit})}})}}},onVerifyIcon:function(e){var t=e.oSource.getValue();if(sap.ui.core.IconPool.isIconURI(t)){e.oSource.setValueHelpIconSrc(t);this.byId("OSIcon").setIcon(t)}else{e.oSource.setValueHelpIconSrc("sap-icon://sys-help-2");this.byId("OSIcon").setIcon("sap-icon://sys-help-2")}},onPermToChange:function(e){var t=this.getModel("AppDetail").getProperty("/editable");if(t){this.getModel("AppDetail").setProperty("/editable",false);e.oSource.setProperty("icon","sap-icon://edit")}else{this.getModel("AppDetail").setProperty("/editable",true);e.oSource.setProperty("icon","sap-icon://not-editable")}},onNavBack:function(){this.getRouter().navTo("RouteMain")},_onObjectMatched:function(e){var t="/xTQAxAPPLICATIONS_DD"+e.getParameter("arguments").objectId;this._bindView(t)},_bindView:function(e){this.getModel("AppDetail").setProperty("/sPath",e);this.getModel("AppDetail").setProperty("/editable",false);var t=this.getModel("AppDetail");if(e!="/xTQAxAPPLICATIONS_DD('000')"){this.getView().bindElement({path:e,events:{dataRequested:function(){t.setProperty("/busy",true)},dataReceived:function(e){t.setProperty("/busy",false)}}})}else{this.onCreateMethod()}},onCreateMethod:function(){this.byId("MainPage").setTitle("Criar Aplicação");this.getModel("AppDetail").setProperty("/editable",true);this.byId("btChange").setProperty("visible",false);this.byId("btCreateUpdate").setText("Create");this.getModel("AppDetail").setProperty("/createMethod",true)},onTranslateApp:function(){var e=this.byId("requestTableLanguages"),t=e.getSelectedItem().getCells(),i=t[0].getText(),s=t[1].getText(),o=t[2].getText();if(!this.oResizableDialog){var n=new a({layout:"ResponsiveGridLayout",content:[new sap.m.Label({text:"{i18n>AppLangu}"}),new sap.m.Input({id:"inLangu",enabled:false,setValue:"",layoutData:new sap.m.FlexItemData({styleClass:"sapUiSmallMarginBottom"}),required:true}),new sap.m.Label({text:"{i18n>AppHeader}"}),new sap.m.Input({id:"inAppHeader",setValue:"",layoutData:new sap.m.FlexItemData({styleClass:"sapUiSmallMarginBottom"}),required:true}),new sap.m.Label({text:"{i18n>AppHeader}"}),new sap.m.Input({id:"inAppSubHeader",setValue:"",layoutData:new sap.m.FlexItemData({styleClass:"sapUiSmallMarginBottom"}),required:true})]});var p=new sap.m.Button({text:"{i18n>Save}",press:function(){var e=true;var t=this.getModel();var a=this.byId("requestTableLanguages");var i=a.getSelectedContexts()[0].sPath;n.getContent().forEach(function(t){if(t instanceof sap.m.Input){if(t.getRequired()&&!t.getValue()){e=false;t.setValueState("Error");return false}else{t.setValueState("None")}}});if(e){var s={};var o=this;s.AppHeader=sap.ui.getCore().byId("inAppHeader").getValue();s.AppSubheader=sap.ui.getCore().byId("inAppSubHeader").getValue();t.update(i,s,{success:function(){sap.m.MessageBox.success(o.getResourceBundle().getText("translatesucess"));t.refresh(true)}});this.oResizableDialog.close();this.oResizableDialog.destroy();this.oResizableDialog.destroy();this.oResizableDialog=null}}.bind(this)});var r=new sap.m.Button({text:"{i18n>close}",press:function(){this.oResizableDialog.close();this.oResizableDialog.destroy();this.oResizableDialog.destroy();this.oResizableDialog=null}.bind(this)});this.oResizableDialog=new sap.m.Dialog({title:"{i18n>Translate}",contentWidth:"440px",contentHeight:"430px",resizable:true,content:[n],buttons:[p,r]});if(this.oResizableDialog){var l=sap.ui.getCore().byId("inLangu");var d=sap.ui.getCore().byId("inAppHeader");var u=sap.ui.getCore().byId("inAppSubHeader");l.setValue(i);d.setValue(s);u.setValue(o)}this.getView().addDependent(this.oResizableDialog)}this.oResizableDialog.open()}})});
//# sourceMappingURL=AppDetail.controller.js.map